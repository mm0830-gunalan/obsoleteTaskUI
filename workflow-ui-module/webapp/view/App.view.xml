<mvc:View
    controllerName="obsoletetaskform.workflowuimodule.controller.App"
    xmlns:html="http://www.w3.org/1999/xhtml"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:table="sap.ui.table"
    height="100%"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.ui.layout.form"
>
    <App id="app">
        <Page
            showHeader="false"
            enableScrolling="false"
            class="sapUiContentPadding"
        >
            <content>
                <FlexBox
                    direction="Column"
                    height="100%"
                    fitContainer="true"
                >
                    <VBox class="sapUiSmallMargin">
                        <layoutData>
                            <FlexItemData
                                growFactor="0"
                                shrinkFactor="0"
                            />
                        </layoutData>
                        <f:Form editable="false">
                            <f:layout>
                                <f:ResponsiveGridLayout
                                    singleContainerFullSize="false"
                                />
                            </f:layout>
                            <f:formContainers>
                                <f:FormContainer>
                                    <f:formElements>
                                        <f:FormElement
                                            label="{i18n>labelCompanyCode}"
                                        >
                                            <f:fields>
                                                <Text
                                                    text="{context>/companyCode}"
                                                />
                                            </f:fields>
                                        </f:FormElement>
                                    </f:formElements>
                                </f:FormContainer>
                            </f:formContainers>
                        </f:Form>
                    </VBox>

                    <table:Table
                        id="obsoleteTable"
                        rows="{context>/obsoleteItems}"
                        selectionMode="MultiToggle"
                        visibleRowCountMode="Auto"
                        fixedColumnCount="3"
                    >
                        <table:layoutData>
                            <FlexItemData
                                growFactor="1"
                                shrinkFactor="1"
                                baseSize="0%"
                            />
                        </table:layoutData>
                        <table:extension>
                            <OverflowToolbar style="Clear">
                                <Title id="title" />
                                <ToolbarSpacer />
                                <!-- SEARCH / FILTER -->
                                <SearchField
                                    visible="true"
                                    placeholder="{i18n>searchPlaceholder}"
                                    liveChange="onSearch"
                                    width="15rem"
                                />
                                <Button
                                    icon="sap-icon://filter"
                                    press="onOpenFilterDialog"
                                    tooltip="{i18n>tooltipFilter}"
                                    visible="false"
                                />
                                <Button
                                    icon="sap-icon://excel-attachment"
                                    tooltip="{i18n>tooltipExportExcel}"
                                    press="onExportObsoleteItems"
                                    visible="false"
                                />
                                <Button
                                    text="{i18n>btnDelete}"
                                    type="Reject"
                                    icon="sap-icon://delete"
                                    press="onDeleteSelected"
                                />

                                <Button
                                    icon="sap-icon://clear-filter"
                                    tooltip="{i18n>btnClearFilters}"
                                    press="onClearAllFilters"
                                />

                                <!--  EXTRA CUSTOM BUTTON -->
                                <Button
                                    text="{i18n>btnUpdateHandling}"
                                    type="Emphasized"
                                    press="onUpdateHandling"
                                    visible="{context>/handlingEditable}"
                                />
                                <Button
                                    text="{i18n>btnUpdateScrap}"
                                    type="Emphasized"
                                    press="onUpdateScrap"
                                    visible="{context>/scrapEditable}"
                                />
                                <Button
                                    text="{i18n>btnUpdateCustomer}"
                                    type="Emphasized"
                                    press="onUpdateCustomer"
                                    visible="{context>/componentVisible}"
                                />

                                <!-- Adding two more button for comment -->
                                <Button
                                    text="{i18n>btnShowComments}"
                                    icon="sap-icon://history"
                                    tooltip="{i18n>tooltipShowComments}"
                                    press="onShowAllComments"
                                    type="Transparent"
                                />

                                <Button
                                    text="{i18n>btnUpdateInternal}"
                                    type="Emphasized"
                                    press="onUpdateInternal"
                                    visible="{context>/alternativeVisible}"
                                />

                                <Button
                                    text="{i18n>btnUpdateSubsidiary}"
                                    type="Emphasized"
                                    press="onUpdateSubsidiary"
                                    visible="{context>/subsidiaryVisible}"
                                />

                                <Button
                                    type="Accept"
                                    text="{i18n>btnSave}"
                                    press=".onSave"
                                />
                            </OverflowToolbar>
                        </table:extension>
                        <table:columns>
                            <table:Column
                                width="5rem"
                                sortProperty="plant"
                                filterProperty="plant"
                            >
                                <Label text="{i18n>colPlant}" />
                                <table:template>
                                    <Text text="{context>plant}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="15rem"
                                sortProperty="component"
                                filterProperty="component"
                            >
                                <Label text="{i18n>colComponent}" />
                                <table:template>
                                    <Text text="{context>component}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="17rem"
                                sortProperty="description"
                                filterProperty="description"
                            >
                                <Label text="{i18n>colDescription}" />
                                <table:template>
                                    <Text
                                        text="{context>description}"
                                        wrapping="false"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="12rem"
                                sortProperty="rfqId"
                                filterProperty="rfqId"
                            >
                                <Label text="{i18n>colRfqId}" />
                                <table:template>
                                    <Text text="{context>rfqId}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="13rem"
                                sortProperty="manufacturerPart"
                                filterProperty="manufacturerPart"
                            >
                                <Label text="{i18n>colManufacturerPart}" />
                                <table:template>
                                    <Text text="{context>manufacturerPart}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="8rem"
                                sortProperty="availableStock"
                                filterProperty="availableStock"
                            >
                                <Label text="{i18n>colAvailableStock}" />
                                <table:template>
                                    <Text text="{context>availableStock}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="14rem"
                                sortProperty="availableCu"
                                filterProperty="availableCu"
                            >
                                <Label text="{i18n>colAvailableCu}" />
                                <table:template>
                                    <Text text="{context>availableCu}" />
                                </table:template>
                            </table:Column>

                            <table:Column width="5rem">
                                <Label text="{i18n>colCurrency}" />
                                <table:template>
                                    <Text text="{context>currency}" />
                                </table:template>
                            </table:Column>

                            <table:Column width="9rem">
                                <Label text="{i18n>colLastConsumption}" />
                                <table:template>
                                    <Text
                                        text="{path: 'context>lastConsumption', type: 'sap.ui.model.type.Date', formatOptions: {pattern: 'dd.MM.yyyy'}}"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="8rem"
                                sortProperty="rangeCoverage"
                                filterProperty="rangeCoverage"
                            >
                                <Label text="{i18n>colRangeCoverage}" />
                                <table:template>
                                    <Text text="{context>rangeCoverage}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="10rem"
                                sortProperty="pn"
                                filterProperty="pn"
                            >
                                <Label text="{i18n>colPn}" />
                                <table:template>
                                    <Text text="{context>pn}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="10rem"
                                sortProperty="customer"
                                filterProperty="customer"
                            >
                                <Label text="{i18n>colCustomer}" />
                                <table:template>
                                    <Text text="{context>customer}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="10rem"
                                sortProperty="endCustomer"
                                filterProperty="endCustomer"
                            >
                                <Label text="{i18n>colEndCustomer}" />
                                <table:template>
                                    <Text text="{context>endCustomer}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="8rem"
                                sortProperty="reason"
                                filterProperty="reason"
                            >
                                <Label text="{i18n>colReason}" />
                                <table:template>
                                    <Text text="{context>reason}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="7rem"
                                sortProperty="caused"
                                filterProperty="caused"
                            >
                                <Label text="{i18n>colCaused}" />
                                <table:template>
                                    <Text text="{context>caused}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="8rem"
                                sortProperty="totalAmount"
                                filterProperty="totalAmount"
                            >
                                <Label text="{i18n>colTotalAmount}" />
                                <table:template>
                                    <Text text="{context>totalAmount}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="8rem"
                                sortProperty="weight"
                                filterProperty="weight"
                            >
                                <Label text="{i18n>colWeight}" />
                                <table:template>
                                    <Text text="{context>weight}" />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="10rem"
                                sortProperty="decisionFlow"
                                filterProperty="decisionFlow"
                                visible="{context>/decisionFlowVisible}"
                            >
                                <Label text="{i18n>colDecisionFlow}" />
                                <table:template>
                                    <Text text="{context>decisionFlow}" />
                                </table:template>
                            </table:Column>

                            <!-- Editable -->
                            <table:Column
                                width="15rem"
                                visible="{context>/handlingVisible}"
                            >
                                <Label
                                    text="{i18n>colHandling}"
                                    required="{context>/handlingRequired}"
                                />
                                <table:template>
                                    <Select
                                        selectedKey="{context>handling}"
                                        editable="{context>/handlingEditable}"
                                        change=".onChangeDropdown"
                                        width="100%"
                                    >
                                        <core:Item
                                            key=""
                                            text="{i18n>selectPlaceholder}"
                                        />
                                        <core:Item
                                            key="Scrapping"
                                            text="{i18n>handlingScrapping}"
                                        />
                                        <core:Item
                                            key="Alternative use"
                                            text="{i18n>handlingAlternative}"
                                        />
                                    </Select>
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="15rem"
                                visible="{context>/componentVisible}"
                            >
                                <Label
                                    text="{i18n>colCustomerResponse}"
                                    required="{context>/componentVisible}"
                                />
                                <table:template>
                                    <Select
                                        selectedKey="{context>customerResponse}"
                                        editable="{context>/componentVisible}"
                                        change=".onChangeDropdown"
                                    >
                                        <core:Item
                                            key=""
                                            text="{i18n>selectPlaceholder}"
                                        />
                                        <core:Item
                                            key="Customer doesn't pay"
                                            text="{i18n>customerNoPay}"
                                        />
                                        <core:Item
                                            key="Customer pays"
                                            text="{i18n>customerPays}"
                                        />
                                        <core:Item
                                            key="Customer purchase obsolete stock"
                                            text="{i18n>customerPurchaseStock}"
                                        />
                                    </Select>
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="10rem"
                                visible="{context>/alternativeVisible}"
                            >
                                <Label text="{i18n>colInternalUse}" />
                                <table:template>
                                    <CheckBox
                                        selected="{context>internalUse}"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="10rem"
                                visible="{context>/subsidiaryVisible}"
                            >
                                <Label text="{i18n>colSellSubsidiary}" />
                                <table:template>
                                    <CheckBox
                                        selected="{context>sellToSubsidiary}"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="15rem"
                                visible="{context>/scrapVisible}"
                            >
                                <Label
                                    text="{i18n>colScrapping}"
                                    required="{context>/scrapRequired}"
                                />
                                <table:template>
                                    <Select
                                        selectedKey="{context>scrapDecision}"
                                        editable="{context>/scrapEditable}"
                                        change=".onChangeDropdown"
                                        width="100%"
                                    >
                                        <core:Item
                                            key=""
                                            text="{i18n>selectPlaceholder}"
                                        />
                                        <core:Item
                                            key="To be scrapped"
                                            text="{i18n>scrapToBeScrapped}"
                                        />
                                        <core:Item
                                            key="Keep"
                                            text="{i18n>scrapKeep}"
                                        />
                                    </Select>
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="18rem"
                                visible="{context>/handlingRequired}"
                            >
                                <Label text="{i18n>colComments}" />
                                <table:template>
                                    <TextArea
                                        width="100%"
                                        value="{context>commentHandling}"
                                        rows="1"
                                        change=".onChangeComment"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="18rem"
                                visible="{context>/scrapRequired}"
                            >
                                <Label text="{i18n>colComments}" />
                                <table:template>
                                    <TextArea
                                        width="100%"
                                        value="{context>commentScrap}"
                                        rows="1"
                                        change=".onChangeComment"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="18rem"
                                visible="{context>/alternativeVisible}"
                            >
                                <Label text="{i18n>colComments}" />
                                <table:template>
                                    <TextArea
                                        width="100%"
                                        value="{context>commentAlternative}"
                                        rows="1"
                                        change=".onChangeComment"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="18rem"
                                visible="{context>/subsidiaryVisible}"
                            >
                                <Label text="{i18n>colComments}" />
                                <table:template>
                                    <TextArea
                                        width="100%"
                                        value="{context>commentSubsidiary}"
                                        rows="1"
                                        change=".onChangeComment"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                width="18rem"
                                visible="{context>/componentVisible}"
                            >
                                <Label text="{i18n>colComments}" />
                                <table:template>
                                    <TextArea
                                        width="100%"
                                        value="{context>commentComponent}"
                                        rows="1"
                                        change=".onChangeComment"
                                    />
                                </table:template>
                            </table:Column>
                        </table:columns>
                        <!-- <table:footer>
                            <OverflowToolbar id="otbFooter">
                                <ToolbarSpacer />
                                <Button
                                    type="Accept"
                                    text="Save"
                                    press=".onSave"
                                >
                                    <layoutData>
                                        <OverflowToolbarLayoutData
                                            priority="NeverOverflow"
                                        />
                                    </layoutData>
                                </Button>
                            </OverflowToolbar>
                        </table:footer> -->
                    </table:Table>
                    <VBox height="60px">
                        <layoutData>
                            <FlexItemData
                                growFactor="0"
                                shrinkFactor="0"
                            />
                        </layoutData>
                    </VBox>
                </FlexBox>
            </content>
        </Page>
    </App>
</mvc:View>
